# The name of the bundle. run `databricks bundle schema` to see the full bundle settings schema.
bundle:
  # Do not modify the below line, this autogenerated field is used by the Databricks backend. Identifies your Databricks Asset Bundle (DAB) project.
  uuid: d9ca5afd-86a4-4b82-a9ea-ec85a2de8d32
  name: ngm_mlops

variables:
  databricks_host:
    description: "Databricks workspace host URL (e.g., https://adb-xxxx.xx.azuredatabricks.net)"
    default: ""
  experiment_name:
    description: Experiment name for the model training.
    default: /Users/${workspace.current_user.userName}/${bundle.target}-ngm_mlops-experiment
  git_sha:
    description: "Git commit SHA"
    default: "local"
  model_name:
    description: Model name for the model training.
    default: ngm_mlops-model
  catalog_name:
    description: The catalog name to save the trained model
    
include:
  # Resources folder contains ML artifact resources for the ML project that defines model and experiment
  # And workflows resources for the ML project including model training -> validation -> deployment,
  # feature engineering,  batch inference, quality monitoring, metric refresh, alerts and triggering retraining
  - resources/jobs/*.yml
  #- resources/models
  #- resources/serving
  # TODO: uncomment once monitoring inference table has been created
  # - ./resources/monitoring-resource.yml

sync:
  include:
    - src

# Deployment Target specific values for workspaces
targets:
  rnd:  # Research & Development - for active development
    mode: development
    default: true
    variables:
      catalog_name: rnd
      git_sha: "rnd-build"
      workspace_path: "~/Repos/ngm_mlops-rnd"
    workspace:
      host: ${var.databricks_host}  # Set via env var or CLI: --var="databricks_host=https://..."
      root_path: ${var.workspace_path}

  dev:  # Development - for unit testing
    mode: development
    variables:
      catalog_name: dev
      git_sha: "dev-build"
      workspace_path: "~/Repos/ngm_mlops-dev"
    workspace:
      host: ${var.databricks_host}
      root_path: ${var.workspace_path}

  uat:  # User Acceptance Testing - for integration testing
    variables:
      catalog_name: uat
      git_sha: "uat-build"
      workspace_path: "/Workspace/Repos/ngm_mlops-uat"
    workspace:
      host: ${var.databricks_host}
      root_path: ${var.workspace_path}

  preprod:  # Pre-Production - final staging before prod
    variables:
      catalog_name: preprod
      git_sha: "preprod-build"
      workspace_path: "/Workspace/Repos/ngm_mlops-preprod"
    workspace:
      host: ${var.databricks_host}
      root_path: ${var.workspace_path}

  prod:  # Production - final deployment
    variables:
      catalog_name: prod
      git_sha: "prod-build"
      workspace_path: "/Workspace/Repos/ngm_mlops-prod"
    workspace:
      host: ${var.databricks_host}
      root_path: ${var.workspace_path}
